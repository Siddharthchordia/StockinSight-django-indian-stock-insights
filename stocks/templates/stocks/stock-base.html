{% extends "stocks/base.html" %}
{% load humanize %}
{% load finance_filters %}

{% block container_class %}max-w-screen-2xl{% endblock %}

{% block head_title %}
{{ company.name }} - Financials
{% endblock %}

{% block maincontent %}
<div class="space-y-5">
    <!-- Header / Stock Info -->
    <div class="glass-panel p-6 rounded-2xl">
        <div class="flex justify-between items-start">
            <div>
                <h1 class="text-4xl font-bold text-slate-900 mb-2">
                    {{ company.name }}
                </h1>

                <div class="text-slate-500 text-sm flex gap-6 items-center">
                    <span>
                        Ticker:
                        <span class="text-slate-800 font-medium">
                            {{ company.ticker }}
                        </span>
                    </span>
                    <span>
                        Sector:
                        <span class="text-slate-800 font-medium">
                            {{ company.sector }}
                        </span>
                    </span>
                    <span>
                        Exchange:
                        <span class="text-slate-800 font-medium">
                            {{ company.get_exchange_display }}
                        </span>
                    </span>
                    
                    
                </div>
            </div>
            <div class="text-right">
                <div class="text-3xl font-bold text-amber-600">
                    ₹{{ snapshot.price|default:"--"|floatformat:2|intcomma }}
                </div>
                <div class="text-sm text-amber-500">
                    Current Price
                </div>
            </div>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4 text-sm pt-2">
        <div>
            <div class="text-slate-500">Revenue</div>
            <div class="font-semibold text-slate-800">
                ₹{{ fundamentals.revenue|default:"--"|floatformat:0 |intcomma }} Crs.
            </div>
        </div>

        <div>
            <div class="text-slate-500">Op. Margin</div>
            <div class="font-semibold text-slate-800">
                {{ fundamentals.operating_margin|default:"--"|floatformat:2 }}%
            </div>
        </div>

        <div>
            <div class="text-slate-500">Net Margin</div>
            <div class="font-semibold text-slate-800">
                {{ fundamentals.net_margin|default:"--"|floatformat:2 }}%
            </div>
        </div>

        <div>
            <div class="text-slate-500">ROE</div>
            <div class="font-semibold text-slate-800">
                {{ fundamentals.roe|default:"--"|floatformat:2 }}%
            </div>
        </div>

        <div>
            <div class="text-slate-500">ROCE</div>
            <div class="font-semibold text-slate-800">
                {{ fundamentals.roce|default:"--"|floatformat:2 }}%
            </div>
        </div>

        <div>
            <div class="text-slate-500">Debt / Equity</div>
            <div class="font-semibold text-slate-800">
                {{ fundamentals.debt_to_equity|default:"--"|floatformat:2 }}
            </div>
        </div>
        <div>
            <div class="text-slate-500">Market Cap.</div>
            <div class="font-semibold text-slate-800">
                ₹{{ snapshot.market_cap | to_crore |default:"--"| floatformat:2|intcomma }} Crs.
            </div>
        </div>
        <div>
            <div class="text-slate-500">P/E</div>
            <div class="font-semibold text-slate-800">
                {{ snapshot.pe |default:"--"| floatformat:2 }} 
            </div>
        </div>
        <div>
            <div class="text-slate-500">P/B</div>
            <div class="font-semibold text-slate-800">
                {{ snapshot.pb |default:"--"| floatformat:2 }} 
            </div>
        </div>
        <div>
            <div class="text-slate-500">52W High/Low</div>
            <div class="font-semibold text-slate-800">
                {{ snapshot.high_52w |default:"--"| floatformat:0|intcomma }} / {{ snapshot.low_52w |default:"--"| floatformat:0|intcomma }}
            </div>
        </div>


    </div>
</div>


    {% include "stocks/partials/financial_table.html" with title="Quarterly Results" table_data=quarterly_data periods=quarterly_periods %}

    {% include "stocks/partials/financial_table.html" with title="Profit & Loss" table_data=pnl_data periods=pnl_periods %}

    {% include "stocks/partials/financial_table.html" with title="Balance Sheet" table_data=bs_data periods=bs_periods %}

    {% include "stocks/partials/financial_table.html" with title="Cash Flows" table_data=cf_data periods=cf_periods %}

</div>

<style>
.glass-panel {
    background:
        linear-gradient(
            135deg,
            rgba(255, 255, 255, 0.85),
            rgba(255, 255, 255, 0.6)
        );
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.7);
    box-shadow:
        0 24px 48px rgba(15, 23, 42, 0.08),
        inset 0 1px 1px rgba(255, 255, 255, 0.9);
}
</style>
{% endblock maincontent%}
